<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=X-XXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'X-XXXXXXX');
</script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta charset="utf-8"/>
<meta name="description" content="Structured data exchange for C/C++"/>
<meta name="keywords" content="structured data, data exchange, C, C++, library"/>
<meta name="author" content="Attila Kovacs"/>
<meta name="copyright" content="(C)2024 Attila Kovacs" />
<meta name="robots" content="index,follow"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=X-XXXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'X-XXXXXXXX');
</script>
<link rel="shortcut icon" type="image/x-icon" href="/xchange/resources/favicon.ico" />
<link rel="icon" type="image/png" sizes="192x192" href="/xchange/resources/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="/xchange/resources/android-chrome-512x512.png" />
<link rel="apple-touch-icon" type="image/png" href="/xchange/resources/apple-touch-icon.png" />
<title>xchange: xchange</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">xchange<span id="projectnumber">&#160;v0.9</span>
   </div>
   <div id="projectbrief">Structured data exchange for C/C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">xchange </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README-orig"></a> Platform-agnostic data exchange framework for C/C++ with built-in JSON parser/emitter support.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Table of Contents</h2>
<ul>
<li><a class="el" href="#introduction">Introduction</a></li>
<li><a class="el" href="#data-types">Basic data types</a></li>
<li><a class="el" href="#structured-data">Structured data</a></li>
<li><a class="el" href="#json-interchange">JSON parser and emitter</a></li>
<li><a class="el" href="#error-handling">Error handling</a></li>
<li><a class="el" href="#debugging-support">Debugging support</a></li>
</ul>
<p><a class="anchor" id="introduction"></a> </p>
<h2><a class="anchor" id="autotoc_md3"></a>
Introduction</h2>
<p>The <b>xchange</b> library provides a framework for platform independent data exchange for structured data in C/C++, and includes a JSON parser and emitter.</p>
<p>While there are many excellent libraries out there that offer such capabilities for C++ and/or other object-oriented languages, support for structured data exchange is notably rare for standard C. The <b>xchange</b> library aims to fill that niche, by providing a data exchange framework with a C90-compatible API that supports the interchange of arbitrary structured data between different platforms and different serialization formats with ease. The <b>xchange</b> library also provides support for JSON formatting and parsing using the C90 standard out of the box. All that in a light-weight and fast package.</p>
<p>The <b>xchange</b> library was created, and is maintained, by Attila Kov√°cs at the Center for Astrophysics | Harvard &amp; Smithsonian, and it is available through the <a href="https://github.com/Smithsonian/xchange">Smithsonian/xchange</a> repository on GitHub.</p>
<ul>
<li><a href="https://smithsonian.github.io/xchange">Project page</a> on github.io, including</li>
<li><a href="https://smithsonian.github.io/xchange/apidoc/html/files.html">API documentation</a>.</li>
</ul>
<p><a class="anchor" id="data-types"></a> </p>
<h2><a class="anchor" id="autotoc_md4"></a>
Basic data types</h2>
<ul>
<li><a class="el" href="#strings">Strings</a></li>
</ul>
<p>The <b>xchange</b> library supports most basic (primitive) data types used across programming languages. The table below shows the (<code>XType</code>) types recognised by the library and their C equivalents etc.:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><b>xchange</b> type   </th><th class="markdownTableHeadNone">C type   </th><th class="markdownTableHeadNone">Comment / example    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>X_BOOLEAN</code>   </td><td class="markdownTableBodyNone"><code>boolean</code><sup>*</sup>   </td><td class="markdownTableBodyNone">'<code>true</code>' or '<code>false</code>'    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>X_BYTE</code>   </td><td class="markdownTableBodyNone"><code>char</code> or <code>int8_t</code>   </td><td class="markdownTableBodyNone">'<code>-128</code>' to '<code>127</code>'    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>X_BYTE_HEX</code>   </td><td class="markdownTableBodyNone"><code>char</code> or <code>[u]int8_t</code>   </td><td class="markdownTableBodyNone">'<code>0x0</code>' to '<code>0xff</code>' (hexadeximal representation)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>X_SHORT</code>   </td><td class="markdownTableBodyNone"><code>short</code> or <code>int16_t</code>   </td><td class="markdownTableBodyNone">'<code>-32768</code>' to '<code>32767</code>'    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>X_SHORT_HEX</code>   </td><td class="markdownTableBodyNone"><code>short</code> or <code>[u]int16_t</code>   </td><td class="markdownTableBodyNone">'<code>0x0</code>' to '<code>0xffff</code>' (hexadeximal representation)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>X_INT</code>   </td><td class="markdownTableBodyNone"><code>int32_t</code>   </td><td class="markdownTableBodyNone">'<code>-2,147,483,648</code>' to '<code>2,147,483,647</code>'    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>X_INT_HEX</code>   </td><td class="markdownTableBodyNone"><code>[u]int32_t</code>   </td><td class="markdownTableBodyNone">'<code>0x0</code>' to '<code>0xffffffff</code>' (hexadeximal representation)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>X_LONG</code>   </td><td class="markdownTableBodyNone"><code>long long</code> or <code>int64_t</code>   </td><td class="markdownTableBodyNone">'<code>-9,223,372,036,854,775,808</code>' to '<code>9,223,372,036,854,775,807</code>'    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>X_LONG_HEX</code>   </td><td class="markdownTableBodyNone"><code>[u]int64_t</code>   </td><td class="markdownTableBodyNone">'<code>0x0</code>' to '<code>0xffffffffffffffff</code>' (hex. representation)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>X_FLOAT</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone"><code>1</code>, <code>1.0</code>, <code>-1.234567e-33</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>X_DOUBLE</code>   </td><td class="markdownTableBodyNone"><code>double</code>   </td><td class="markdownTableBodyNone"><code>1</code>, <code>1.0</code>, <code>-1.2345678901234567e-111</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>X_STRING</code>   </td><td class="markdownTableBodyNone"><code>char *</code>   </td><td class="markdownTableBodyNone"><code>Hello world!</code>, <code>line1\nline2\n</code> (0-terminated)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="xchange_8h.html#a76d723969626d4e25235eb24533e3e3a" title="A fixed-size character sequence of &#39;length&#39; bytes.">X_CHARS(n)</a></code>   </td><td class="markdownTableBodyNone"><code>char[n]</code>   </td><td class="markdownTableBodyNone">Fixed-length character arrays (also w/o termination)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>X_STRUCT</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="structXStructure.html" title="SMA-X structure object, containing a linked-list of XField elements.">XStructure</a></code>   </td><td class="markdownTableBodyNone">structured data in <b>xchange</b>   </td></tr>
</table>
<p><sup>*</sup> The <code>boolean</code> type is defined in <code><a class="el" href="xchange_8h.html">xchange.h</a></code>.</p>
<p>The <code>[...]_HEX</code> types are meaningful only for ASCII serialization implementations, and are otherwise equivalent to the corresponding regular integer-types of the same width. They are meant only as a way to explicitly define whether or not an integer value is to be represented in hexadecimal format rather than the default decimal format.</p>
<p><a class="anchor" id="strings"></a> </p>
<h3><a class="anchor" id="autotoc_md5"></a>
Strings</h3>
<p>Strings can be either fixed-length or else a 0-terminated sequence of ASCII characters. At its basic level the library does not impose any restriction of what ASCII characters may be used. However, we recommend that users stick to the JSON convention, and represent special characters in escaped form. E.g. carriagle return (<code>0xd</code>) as <code>\</code> followed by <code>n</code>, tabs as <code>\</code> followed by <code>t</code>, etc. As a result a single backslash should also be escaped as two consecutive <code>\</code> characters. You might use <code><a class="el" href="xjson_8c.html#aad83ebcc397046a875040dfc2297d892">xjsonEscapeString()</a></code> or <code><a class="el" href="xjson_8c.html#ae11aed18561818c2e39a5709a8e3374d">xjsonUnescapeString()</a></code> to perform the conversion to/from standard JSON representation.</p>
<p>Fixed-length strings of up to <em>n</em> characters are represented internally as the <code>XCHAR(n)</code> type. They may be 0-terminated as appropriate, or else represent exactly <em>n</em> ASCII characters without explicit termination. Alternatively, the <code>X_STRING</code> type represents ASCII strings of arbitrary length, up to the 0-termination character.</p>
<p><a class="anchor" id="structured-data"></a> </p>
<h2><a class="anchor" id="autotoc_md6"></a>
Structured data</h2>
<ul>
<li><a class="el" href="#xstructure-type">XStructure type</a></li>
<li><a class="el" href="#arrays">Arrays</a></li>
<li><a class="el" href="#creating-structured-data">Creating structured data</a></li>
<li><a class="el" href="#aggregate-ids">Aggregate IDs</a></li>
<li><a class="el" href="#accessing-data-in-xstructures">Accessing data in XStructures</a></li>
</ul>
<p><a class="anchor" id="xstructure-type"></a> </p>
<h3><a class="anchor" id="autotoc_md7"></a>
XStructure type</h3>
<p>The <b>xchange</b> library defines the <code><a class="el" href="structXStructure.html" title="SMA-X structure object, containing a linked-list of XField elements.">XStructure</a></code> type to represent structured data. It is defined in <code><a class="el" href="xchange_8h.html">xchange.h</a></code>, but as a user you really do not need to know much about its layout, as you probably want to avoid low-level direct access to its elements. Rather, you should be using the functions of the <b>xchange</b> API to create, modify, or access data within.</p>
<p>Under the hood, the <code><a class="el" href="structXStructure.html" title="SMA-X structure object, containing a linked-list of XField elements.">XStructure</a></code> contains a linked list of fields, each an <code><a class="el" href="structXField.html" title="An SMA-X field, typically as part of an XStructure. A field may be a reference to a nested XStructure...">XField</a></code> data type to represent a single element, or an array of elements, of the above mentioned types, including embedded <code>Xstructure</code>s. In this way, an <code>Xstructure</code> can easily represent a multi-level hierarchy of a composite data object. Each <code><a class="el" href="structXField.html" title="An SMA-X field, typically as part of an XStructure. A field may be a reference to a nested XStructure...">XField</a></code> has a name/ID, an associated data type, a dimensionality, a shape (for multidimensional arrays).</p>
<p><a class="anchor" id="arrays"></a> </p>
<h3><a class="anchor" id="autotoc_md8"></a>
Arrays</h3>
<p>The <b>xchange</b> library supports array data types in one or more dimensions (up to 20 dimensions). For example, to create a field for 2&times;3&times;4 array of <code>double</code>s, you may have something along:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> data[2][3][4] = ...;       <span class="comment">// The native array in C</span></div>
<div class="line"><span class="keywordtype">int</span> sizes[] = { 2, 3, 4 };        <span class="comment">// An array containing the dimensions for xchange</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a field for the 3-dimensional array with the specified shape.</span></div>
<div class="line"><a class="code hl_struct" href="structXField.html">XField</a> *f = <a class="code hl_function" href="xstruct_8c.html#a42e4e75cbf8f721ef4b251c692dcd7cb">xCreateField</a>(<span class="stringliteral">&quot;my-array&quot;</span>, <a class="code hl_define" href="xchange_8h.html#a849c7ccb02f63d8554323a889a3d8b4d">X_DOUBLE</a>, 3, sizes, data);</div>
<div class="ttc" id="astructXField_html"><div class="ttname"><a href="structXField.html">XField</a></div><div class="ttdoc">An SMA-X field, typically as part of an XStructure. A field may be a reference to a nested XStructure...</div><div class="ttdef"><b>Definition</b> xchange.h:99</div></div>
<div class="ttc" id="axchange_8h_html_a849c7ccb02f63d8554323a889a3d8b4d"><div class="ttname"><a href="xchange_8h.html#a849c7ccb02f63d8554323a889a3d8b4d">X_DOUBLE</a></div><div class="ttdeci">#define X_DOUBLE</div><div class="ttdoc">double-precision (64) bit floating point XType</div><div class="ttdef"><b>Definition</b> xchange.h:62</div></div>
<div class="ttc" id="axstruct_8c_html_a42e4e75cbf8f721ef4b251c692dcd7cb"><div class="ttname"><a href="xstruct_8c.html#a42e4e75cbf8f721ef4b251c692dcd7cb">xCreateField</a></div><div class="ttdeci">XField * xCreateField(const char *name, XType type, int ndim, const int *sizes, const void *value)</div><div class="ttdef"><b>Definition</b> xstruct.c:228</div></div>
</div><!-- fragment --><p>Note, that there is no requirement that the native array has the same dimensionality as it's nominal format in the field. We could have declared <code>data</code> as a 1D array <code>double data[2 * 3 * 4] = ...</code>, or really any array (pointer) containing doubles with storage for at least 24 elements. It is the <code>sizes</code> array, along with the dimensionality, which together define the shape of the field for <b>xchange</b>.</p>
<h3><a class="anchor" id="autotoc_md9"></a>
Scalar values</h3>
<p>Scalar values are a special case of arrays containing a single element. Scalars have dimension zero i.e., a shape defined by an empty integer array, e.g. <code>int shape[0]</code> in a corresponding <code><a class="el" href="structXField.html" title="An SMA-X field, typically as part of an XStructure. A field may be a reference to a nested XStructure...">XField</a></code> element.</p>
<p>In this way scalars are distinsguished from true arrays containing just a single elements, which have dimensionality &lt;=1 and shapes e.g., <code>int shape[1] = {1}</code> or <code>shape[2] = {1, 1}</code>. The difference, while subtle, becomes more obvious when serializing the array, e.g. to JSON. A scalar floating point value of 1.04, for example, will appear as <code>1.04</code> in JSON, whereas the 1D and 2D single-element arrays will be serialized as <code>{ 1.04 }</code> or <code>{{ 1.04 }}</code>, respectively.</p>
<p><a class="anchor" id="creating-structured-data"></a> </p>
<h3><a class="anchor" id="autotoc_md10"></a>
Creating structured data</h3>
<p>Structures should always be created by calling <code><a class="el" href="xstruct_8c.html#ab551d2db420303b4408064a66bbe3f1c">xCreateStruct()</a></code> (or else by an appropriate de-serialization function such as <code><a class="el" href="xjson_8c.html#af180900a4afeef713a3fdaeb77a9cba3">xjsonParseAt()</a></code>, or as a copy via <code>xCopyStruct()</code>). Once the structure is no longer used it should be explicitly destroyed (freed) by calling <code><a class="el" href="xstruct_8c.html#a2e12d0147219f85a6ec012d7f475fe21">xDestroyStruct()</a></code>. Named substructures can be added to any structure with <code><a class="el" href="xstruct_8c.html#ad84cbb4639f2fbfb604b698a86caf944">xSetSubstruct()</a></code>, and named fields via <code><a class="el" href="xstruct_8c.html#ab1cb91bd6aa14c0dae9d24bfbe7b76f4">xSetField()</a></code>. That is the gist of it. So for example, the skeleton structure from the example above can be created programatically as:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structXStructure.html">XStructure</a> *s, *sys, *sub;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create the top-level structure</span></div>
<div class="line">s = <a class="code hl_function" href="xstruct_8c.html#ab551d2db420303b4408064a66bbe3f1c">xCreateStruct</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create and add the &quot;system&quot; sub-structure</span></div>
<div class="line">sys = <a class="code hl_function" href="xstruct_8c.html#ab551d2db420303b4408064a66bbe3f1c">xCreateStruct</a>();</div>
<div class="line"><a class="code hl_function" href="xstruct_8c.html#ad84cbb4639f2fbfb604b698a86caf944">xSetSubstruct</a>(s, <span class="stringliteral">&quot;system&quot;</span>, sys);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create and add the &quot;subsystem&quot; sub-structure</span></div>
<div class="line">sub = <a class="code hl_function" href="xstruct_8c.html#ab551d2db420303b4408064a66bbe3f1c">xCreateStruct</a>();</div>
<div class="line"><a class="code hl_function" href="xstruct_8c.html#ad84cbb4639f2fbfb604b698a86caf944">xSetSubstruct</a>(sys, <span class="stringliteral">&quot;subsystem&quot;</span>, sub);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set the &quot;property&quot; field in &quot;subsystem&quot;.</span></div>
<div class="line"><a class="code hl_function" href="xstruct_8c.html#ab1cb91bd6aa14c0dae9d24bfbe7b76f4">xSetField</a>(sub, <span class="stringliteral">&quot;property&quot;</span>, <a class="code hl_function" href="xstruct_8c.html#a9dc77bed0d8b738ba615019721a6a2b6">xCreateStringField</a>(<span class="stringliteral">&quot;some value here&quot;</span>));</div>
<div class="ttc" id="astructXStructure_html"><div class="ttname"><a href="structXStructure.html">XStructure</a></div><div class="ttdoc">SMA-X structure object, containing a linked-list of XField elements.</div><div class="ttdef"><b>Definition</b> xchange.h:121</div></div>
<div class="ttc" id="axstruct_8c_html_a9dc77bed0d8b738ba615019721a6a2b6"><div class="ttname"><a href="xstruct_8c.html#a9dc77bed0d8b738ba615019721a6a2b6">xCreateStringField</a></div><div class="ttdeci">XField * xCreateStringField(const char *name, const char *value)</div><div class="ttdef"><b>Definition</b> xstruct.c:381</div></div>
<div class="ttc" id="axstruct_8c_html_ab1cb91bd6aa14c0dae9d24bfbe7b76f4"><div class="ttname"><a href="xstruct_8c.html#ab1cb91bd6aa14c0dae9d24bfbe7b76f4">xSetField</a></div><div class="ttdeci">XField * xSetField(XStructure *s, XField *f)</div><div class="ttdef"><b>Definition</b> xstruct.c:541</div></div>
<div class="ttc" id="axstruct_8c_html_ab551d2db420303b4408064a66bbe3f1c"><div class="ttname"><a href="xstruct_8c.html#ab551d2db420303b4408064a66bbe3f1c">xCreateStruct</a></div><div class="ttdeci">__inline__ XStructure * xCreateStruct()</div><div class="ttdef"><b>Definition</b> xstruct.c:27</div></div>
<div class="ttc" id="axstruct_8c_html_ad84cbb4639f2fbfb604b698a86caf944"><div class="ttname"><a href="xstruct_8c.html#ad84cbb4639f2fbfb604b698a86caf944">xSetSubstruct</a></div><div class="ttdeci">XField * xSetSubstruct(XStructure *s, const char *name, XStructure *substruct)</div><div class="ttdef"><b>Definition</b> xstruct.c:434</div></div>
</div><!-- fragment --><p>and then eventually destroyed after use as:</p>
<div class="fragment"><div class="line"><span class="comment">// Free up all resources used by the structure &#39;s&#39;</span></div>
<div class="line"><a class="code hl_function" href="xstruct_8c.html#a2e12d0147219f85a6ec012d7f475fe21">xDestroyStruct</a>(s);</div>
<div class="ttc" id="axstruct_8c_html_a2e12d0147219f85a6ec012d7f475fe21"><div class="ttname"><a href="xstruct_8c.html#a2e12d0147219f85a6ec012d7f475fe21">xDestroyStruct</a></div><div class="ttdeci">__inline__ void xDestroyStruct(XStructure *s)</div><div class="ttdef"><b>Definition</b> xstruct.c:618</div></div>
</div><!-- fragment --><p><a class="anchor" id="aggregate-ids"></a> </p>
<h3><a class="anchor" id="autotoc_md11"></a>
Aggregate IDs</h3>
<p>Since the <code><a class="el" href="structXStructure.html" title="SMA-X structure object, containing a linked-list of XField elements.">XStructure</a></code> data type can represent hierarchies of arbitrary depth, with names defined at every level, we can uniquely identify any particular field, at any level, with an aggregate ID, which concatenates the field names eatch every level, top-down, with a separator. The convention of <b>xchange</b> is to use colon (':') as the separator. Consider an example structure (in JSON notation):</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  ...</div>
<div class="line">  system = {</div>
<div class="line">    ...</div>
<div class="line">    subsystem = {</div>
<div class="line">      ...</div>
<div class="line">      property = &quot;some value here&quot;;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Then, the leaf "properly" entry can be 'addressed' with the aggregate ID of <code>system:subsystem:property</code> from the top level. The <code><a class="el" href="xstruct_8c.html#a2cbbd824406d862b2018e28a466ff318">xGetAggregateID()</a></code> function is provided to construct such aggregate IDs by gluing together a leading and trailing component.</p>
<p><a class="anchor" id="accessing-data-in-xstructures"></a> </p>
<h3><a class="anchor" id="autotoc_md12"></a>
Accessing data in XStructures</h3>
<p>Once a structure is populated &ndash; either by having constructed it programatically, or e.g. by parsing a JSON definition of it from a string or file &ndash; you can access its content and/or modify it.</p>
<p>E.g., to retrieve the "property" field from the above example structure:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structXField.html">XField</a> *f = <a class="code hl_function" href="xstruct_8c.html#a442f155b0c6549549737510ce42bb66d">xGetField</a>(s, <span class="stringliteral">&quot;system:subsystem:property&quot;</span>); </div>
<div class="ttc" id="axstruct_8c_html_a442f155b0c6549549737510ce42bb66d"><div class="ttname"><a href="xstruct_8c.html#a442f155b0c6549549737510ce42bb66d">xGetField</a></div><div class="ttdeci">XField * xGetField(const XStructure *s, const char *id)</div><div class="ttdef"><b>Definition</b> xstruct.c:177</div></div>
</div><!-- fragment --><p>or to retrieve the "subsystem" structure from within:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structXStructure.html">XStructure</a> *sub = <a class="code hl_function" href="xstruct_8c.html#a97a58e33c4730e272af459dfb7f016f9">xGetSubstruct</a>(s, <span class="stringliteral">&quot;system:subsystem&quot;</span>);</div>
<div class="ttc" id="axstruct_8c_html_a97a58e33c4730e272af459dfb7f016f9"><div class="ttname"><a href="xstruct_8c.html#a97a58e33c4730e272af459dfb7f016f9">xGetSubstruct</a></div><div class="ttdeci">XStructure * xGetSubstruct(const XStructure *s, const char *id)</div><div class="ttdef"><b>Definition</b> xstruct.c:205</div></div>
</div><!-- fragment --><p>Conversely you can set / update fields in a structure using <code><a class="el" href="xstruct_8c.html#ab1cb91bd6aa14c0dae9d24bfbe7b76f4">xSetField()</a></code> / <code><a class="el" href="xstruct_8c.html#ad84cbb4639f2fbfb604b698a86caf944">xSetSubstruct()</a></code>, e.g.:</p>
<div class="fragment"><div class="line">XStructrure *newsub = ...     <span class="comment">// The new substructure</span></div>
<div class="line"><a class="code hl_struct" href="structXField.html">XField</a> *newfield = ...        <span class="comment">// A new field to set</span></div>
<div class="line"><a class="code hl_struct" href="structXField.html">XField</a> *oldfield, *oldsub;    <span class="comment">// prior entries by the same field name/location (if any)</span></div>
<div class="line"> </div>
<div class="line">oldfield = <a class="code hl_function" href="xstruct_8c.html#ab1cb91bd6aa14c0dae9d24bfbe7b76f4">xSetField</a>(s, newfield);        <span class="comment">// Sets the a field in &#39;s&#39;</span></div>
<div class="line">oldsub = <a class="code hl_function" href="xstruct_8c.html#ad84cbb4639f2fbfb604b698a86caf944">xSetSubstruct</a>(s, <span class="stringliteral">&quot;field&quot;</span>, sub);  <span class="comment">// Set a substructure named &quot;bar&quot; in &#39;s&#39;</span></div>
</div><!-- fragment --><p>The above calls return the old values (if any) for the "foo" and "bar" field in the structure, e.g. so we may dispose of them if appropriate:</p>
<div class="fragment"><div class="line"><span class="comment">// Destroy the replaced fields if they are no longer needed.</span></div>
<div class="line"><a class="code hl_function" href="xstruct_8c.html#ae0ce99c867b11bd14971031eec8ba4ad">xDestroyField</a>(oldfield);</div>
<div class="line"><a class="code hl_function" href="xstruct_8c.html#ae0ce99c867b11bd14971031eec8ba4ad">xDestroyField</a>(oldsub);</div>
<div class="ttc" id="axstruct_8c_html_ae0ce99c867b11bd14971031eec8ba4ad"><div class="ttname"><a href="xstruct_8c.html#ae0ce99c867b11bd14971031eec8ba4ad">xDestroyField</a></div><div class="ttdeci">void xDestroyField(XField *f)</div><div class="ttdef"><b>Definition</b> xstruct.c:630</div></div>
</div><!-- fragment --><p>You can also remove existing fields from structures using <code><a class="el" href="xstruct_8c.html#aec9f913cdb79d8653668a5d9bdda6ab1">xRemoveField()</a></code>, e.g.</p>
<div class="fragment"><div class="line"><span class="comment">// Remove and then destroy the fiueld named &quot;blah&quot; in structure &#39;s&#39;.</span></div>
<div class="line"><a class="code hl_function" href="xstruct_8c.html#ae0ce99c867b11bd14971031eec8ba4ad">xDestroyField</a>(<a class="code hl_function" href="xstruct_8c.html#aec9f913cdb79d8653668a5d9bdda6ab1">xRemoveField</a>(s, <span class="stringliteral">&quot;blah&quot;</span>));</div>
<div class="ttc" id="axstruct_8c_html_aec9f913cdb79d8653668a5d9bdda6ab1"><div class="ttname"><a href="xstruct_8c.html#aec9f913cdb79d8653668a5d9bdda6ab1">xRemoveField</a></div><div class="ttdeci">XField * xRemoveField(XStructure *s, const char *name)</div><div class="ttdef"><b>Definition</b> xstruct.c:481</div></div>
</div><!-- fragment --><p><a class="anchor" id="json-interchange"></a> </p>
<h2><a class="anchor" id="autotoc_md13"></a>
JSON parser and emitter</h2>
<p>Once you have an <code><a class="el" href="structXStructure.html" title="SMA-X structure object, containing a linked-list of XField elements.">XStructure</a></code> data object, you can easily convert it to a JSON string representation, as:</p>
<div class="fragment"><div class="line"><span class="comment">// Obtain a JSON string representation of the structure &#39;s&#39;.</span></div>
<div class="line"><span class="keywordtype">char</span> *json = <a class="code hl_function" href="xjson_8c.html#a53128045970e973134867c96a6465abc">xjsonToString</a>(s);</div>
<div class="ttc" id="axjson_8c_html_a53128045970e973134867c96a6465abc"><div class="ttname"><a href="xjson_8c.html#a53128045970e973134867c96a6465abc">xjsonToString</a></div><div class="ttdeci">char * xjsonToString(const XStructure *s)</div><div class="ttdef"><b>Definition</b> xjson.c:114</div></div>
</div><!-- fragment --><p>Or, you can do the reverse and create an <code><a class="el" href="structXStructure.html" title="SMA-X structure object, containing a linked-list of XField elements.">XStructure</a></code> from its JSON representation, either as a string (a <code>char</code> array):</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> lineNumber = 0;</div>
<div class="line"><a class="code hl_struct" href="structXStructure.html">XStructure</a> *s1 = <a class="code hl_function" href="xjson_8c.html#af180900a4afeef713a3fdaeb77a9cba3">xjsonParseAt</a>(json, &amp;lineNumber);</div>
<div class="line"><span class="keywordflow">if</span> (s1 == NULL) {</div>
<div class="line">   <span class="comment">// Oops, there was some problem...</span></div>
<div class="line">}</div>
<div class="ttc" id="axjson_8c_html_af180900a4afeef713a3fdaeb77a9cba3"><div class="ttname"><a href="xjson_8c.html#af180900a4afeef713a3fdaeb77a9cba3">xjsonParseAt</a></div><div class="ttdeci">XStructure * xjsonParseAt(char **pos, int *lineNumber)</div><div class="ttdef"><b>Definition</b> xjson.c:170</div></div>
</div><!-- fragment --><p>or from a file, e.g. specified by the file name/path that contains a JSON definition of the structured data.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structXStructure.html">XStructure</a> *s1 = <a class="code hl_function" href="xjson_8c.html#afff9ee9473a0c939d18dba977cfac075">xjsonParseFilename</a>(<span class="stringliteral">&quot;myStructure.json&quot;</span>, &amp;lineNumber);</div>
<div class="line"><span class="keywordflow">if</span> (s1 == NULL) {</div>
<div class="line">   <span class="comment">// Oops, there was some problem...</span></div>
<div class="line">}</div>
<div class="ttc" id="axjson_8c_html_afff9ee9473a0c939d18dba977cfac075"><div class="ttname"><a href="xjson_8c.html#afff9ee9473a0c939d18dba977cfac075">xjsonParseFilename</a></div><div class="ttdeci">XStructure * xjsonParseFilename(const char *fileName, int *lineNumber)</div><div class="ttdef"><b>Definition</b> xjson.c:203</div></div>
</div><!-- fragment --><p><a class="anchor" id="error-handling"></a> </p>
<h2><a class="anchor" id="autotoc_md14"></a>
Error handling</h2>
<p>The functions that can encounter an error will return either one of the error codes defined in <code><a class="el" href="xchange_8h.html">xchange.h</a></code>, or NULL pointers. String descriptions for the error codes can be produced by <code><a class="el" href="xchange_8c.html#acc701c734a3b95d356660ca5ee16a96a">xErrorDescription(int)</a></code>. For example,</p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> *text = ...</div>
<div class="line">int status = <a class="code hl_function" href="xchange_8c.html#a7e2e177c11fe7f44ca5ce11f316c0ad9">xParseDouble</a>(text, NULL);</div>
<div class="line"><span class="keywordflow">if</span> (status != <a class="code hl_define" href="xchange_8h.html#a7b2679c964ea5f2160380ed55654b873">X_SUCCESS</a>) {</div>
<div class="line">  <span class="comment">// Ooops, something went wrong...</span></div>
<div class="line">  fprintf(stderr, <span class="stringliteral">&quot;WARNING! %s&quot;</span>, <a class="code hl_function" href="xchange_8c.html#acc701c734a3b95d356660ca5ee16a96a">xErrorDescription</a>(status));</div>
<div class="line">  ...</div>
<div class="line">}</div>
<div class="ttc" id="axchange_8c_html_a7e2e177c11fe7f44ca5ce11f316c0ad9"><div class="ttname"><a href="xchange_8c.html#a7e2e177c11fe7f44ca5ce11f316c0ad9">xParseDouble</a></div><div class="ttdeci">double xParseDouble(const char *str, char **tail)</div><div class="ttdef"><b>Definition</b> xchange.c:366</div></div>
<div class="ttc" id="axchange_8c_html_acc701c734a3b95d356660ca5ee16a96a"><div class="ttname"><a href="xchange_8c.html#acc701c734a3b95d356660ca5ee16a96a">xErrorDescription</a></div><div class="ttdeci">const char * xErrorDescription(int code)</div><div class="ttdef"><b>Definition</b> xchange.c:459</div></div>
<div class="ttc" id="axchange_8h_html_a7b2679c964ea5f2160380ed55654b873"><div class="ttname"><a href="xchange_8h.html#a7b2679c964ea5f2160380ed55654b873">X_SUCCESS</a></div><div class="ttdeci">#define X_SUCCESS</div><div class="ttdoc">hooray!</div><div class="ttdef"><b>Definition</b> xchange.h:24</div></div>
</div><!-- fragment --><p>The JSON parser emitter can also sink its error messages to a designated file or stream, which can be set by <code><a class="el" href="xjson_8c.html#a23a7bd364a80bc2bab9ce917ed5f22ea">xjsonSetErrorStream(FILE *)</a></code>.</p>
<p><a class="anchor" id="debugging-support"></a> </p>
<h2><a class="anchor" id="autotoc_md15"></a>
Debugging support</h2>
<p>The <b>xchange</b> library provides two macros: <code><a class="el" href="xchange_8h.html#a1f038bf7ddb58819805cfc44162cb403" title="Use for generating verbose output.">xvprintf()</a></code> and <code><a class="el" href="xchange_8h.html#a2b0edfea798e9e08122f09dba5f189f8" title="Use for generating debug output.">xdprintf()</a></code>, for printing verbose and debug messages to stderr. Both work just like printf, but they are conditional on verbosity being enabled via <code><a class="el" href="xchange_8c.html#afbe85067ddbc92577cd00ac8f6e3026f">xSetVerbose(boolean)</a></code> and the global variable <code>xDebug</code> being <code>TRUE</code> (non-zero), respectively. Applications using <b>xchange</b> may use these macros to produce their own verbose and/or debugging outputs conditional on the same global settings.</p>
<p>You can also turn debug messages by setting the <code>DEBUG</code> constant to 1 at compile time, e.g. by adding <code>-DDEBUG=1</code> to <code>CFLAGS</code> prior to calling <code>make</code>. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
